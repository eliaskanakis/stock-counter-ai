/*! For license information please see main.544afbac.chunk.js.LICENSE.txt */
(this["webpackJsonpstock-counter-ai"]=this["webpackJsonpstock-counter-ai"]||[]).push([[0],{178:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function i(e){try{a(r.next(e))}catch(t){c(t)}}function s(e){try{a(r.throw(e))}catch(t){c(t)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}a((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,c,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(s){c=[6,s],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};t.__esModule=!0,t.ObjectDetection=t.load=void 0;var c=n(325),i=n(0);t.load=function(e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:if(null==i)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(t=e.base||"lite_mobilenet_v2",n=e.modelUrl,-1===["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(t))throw new Error("ObjectDetection constructed with invalid base model "+t+". Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.");return[4,(r=new s(t,n)).load()];case 1:return o.sent(),[2,r]}}))}))};var s=function(){function e(e,t){this.modelPath="https://storage.googleapis.com/tfhub-visualizers/google/object_detection/mobile_object_localizer_v1/1/model.json"}return e.prototype.load=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return e=this,[4,c.loadGraphModel(this.modelPath)];case 1:return e.model=r.sent(),t=i.zeros([1,192,192,3],"float32"),[4,this.model.executeAsync(t)];case 2:return n=r.sent(),[4,Promise.all(n.map((function(e){return e.data()})))];case 3:return r.sent(),n.map((function(e){return e.dispose()})),t.dispose(),[2]}}))}))},e.prototype.infer=function(e,t,n){return r(this,void 0,void 0,(function(){var t,n,r,c,s,a,u,l;return o(this,(function(o){switch(o.label){case 0:return t=i.tidy((function(){if(e instanceof i.Tensor)return i.expandDims(e);var t=i.browser.fromPixels(e);t=i.image.resizeBilinear(t,[192,192]);var n=i.cast(i.div(t,i.scalar(255)),"float32");return i.expandDims(n)})),n=t.shape[1],r=t.shape[2],e instanceof i.Tensor||(n=e.offsetHeight,r=e.offsetWidth),[4,this.model.executeAsync(t,["num_detections","detection_boxes","detection_scores","detection_classes"])];case 1:return[4,(c=o.sent())[0].dataSync()];case 2:return s=o.sent(),[4,c[1].dataSync()];case 3:return a=o.sent(),[4,c[2].dataSync()];case 4:return u=o.sent(),t.dispose(),i.dispose(c),l=i.getBackend(),"webgl"===i.getBackend()&&i.setBackend("cpu"),l!==i.getBackend()&&i.setBackend(l),[2,this.buildDetectedObjects(r,n,s[0],a,u)]}}))}))},e.prototype.buildDetectedObjects=function(e,t,n,r,o){for(var c=n,i=[],s=0;s<c;s++)if(!(o[s]<.2)){for(var a=[],u=0;u<4;u++)a[u]=r[4*s+u];var l=a[0]*t,d=a[1]*e,f=a[2]*t,b=a[3]*e;a[0]=d,a[1]=l,a[2]=b-d,a[3]=f-l,i.push({bbox:a,class:"",score:o[s]})}return i},e.prototype.detect=function(e,t,n){return void 0===t&&(t=20),void 0===n&&(n=.5),r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.infer(e,t,n)]}))}))},e.prototype.dispose=function(){null!=this.model&&this.model.dispose()},e}();t.ObjectDetection=s},298:function(e,t,n){},305:function(e,t){},306:function(e,t){},314:function(e,t){},317:function(e,t,n){},318:function(e,t,n){},326:function(e,t,n){"use strict";n.r(t);var r=n(20),o=n.n(r),c=n(241),i=n.n(c),s=(n(298),n(174)),a=n(45),u=n(34);var l=function(){return Object(u.jsx)("div",{children:"Home page under construction"})},d=n(8),f=n.n(d),b=n(14),h=n(13),p=n(5),v=(n(324),n(323),n(178));n(317);var j=function(){var e=Object(r.useRef)(null),t=Object(r.useRef)(null),n=Object(r.useState)(v.load()),o=Object(p.a)(n,2),c=o[0],i=o[1],s=Object(r.useState)(null),a=Object(p.a)(s,2),l=(a[0],a[1]),d=Object(r.useState)(null),j=Object(p.a)(d,2),x=(j[0],j[1]);function g(){return(g=Object(h.a)(f.a.mark((function n(){var r,o,i,s,a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c;case 2:return r=n.sent,n.next=5,r.detect(e.current);case 5:for(o=n.sent,i=t.current,(s=i.getContext("2d")).clearRect(0,0,i.width,i.height),i.width=e.current.offsetWidth,i.height=e.current.offsetHeight,s.font="10px Arial",console.log("number of detections: ",o.length),a=0;a<o.length;a++)s.beginPath(),s.rect.apply(s,Object(b.a)(o[a].bbox)),s.lineWidth=1,s.strokeStyle="green",s.fillStyle="green",s.stroke(),s.fillText(o[a].score.toFixed(3)+" "+o[a].class,o[a].bbox[0],o[a].bbox[1]>10?o[a].bbox[1]-5:10);case 14:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(r.useEffect)((function(){i(v.load()),navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then((function(t){e&&e.current&&(e.current.autoplay=!0,e.current.playsinline=!0,e.current.srcObject=t,x(new ImageCapture(t.getVideoTracks()[0])))})).catch((function(e){l(e.message)}))}),[]),Object(r.useEffect)((function(){var n=setInterval(Object(h.a)(f.a.mark((function n(){var r,o,i,s,a;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&e.current){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,c;case 4:return r=n.sent,n.next=7,r.detect(e.current);case 7:for(o=n.sent,i=t.current,(s=i.getContext("2d")).clearRect(0,0,i.width,i.height),i.width=e.current.offsetWidth,i.height=e.current.offsetHeight,s.font="10px Arial",console.log("number of detections: ",o.length),a=0;a<o.length;a++)s.beginPath(),s.rect.apply(s,Object(b.a)(o[a].bbox)),s.lineWidth=1,s.strokeStyle="green",s.fillStyle="green",s.stroke(),s.fillText(o[a].score.toFixed(3)+" "+o[a].class,o[a].bbox[0],o[a].bbox[1]>10?o[a].bbox[1]-5:10);case 16:case"end":return n.stop()}}),n)}))),1e3);return function(){return clearInterval(n)}}),[c]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("video",{className:"video",ref:e}),Object(u.jsx)("button",{className:"shotButton",onClick:function(){return g.apply(this,arguments)}}),Object(u.jsx)("canvas",{id:"canvas",ref:t})]})};n.p,n(318);var x=function(){return Object(u.jsx)(s.a,{children:Object(u.jsxs)("div",{children:[Object(u.jsx)("nav",{children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{children:Object(u.jsx)(s.b,{to:"/",children:"Home"})}),Object(u.jsx)("li",{children:Object(u.jsx)(s.b,{to:"/live-camera",children:"Live Camera"})})]})}),Object(u.jsxs)(a.c,{children:[Object(u.jsx)(a.a,{path:"/live-camera",children:Object(u.jsx)(j,{})}),Object(u.jsx)(a.a,{path:"/",children:Object(u.jsx)(l,{})})]})]})})},g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,327)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),o(e),c(e),i(e)}))};i.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(x,{})}),document.getElementById("root")),g()}},[[326,1,2]]]);
//# sourceMappingURL=main.544afbac.chunk.js.map